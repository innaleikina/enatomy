{"ast":null,"code":"import _classCallCheck from \"/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/src/pages/Cart/Cart.js\";\nimport React, { Component } from 'react';\nimport API from \"../../utils/API\";\nimport { Link } from 'react-router-dom';\nimport CoverPhoto from '../../components/CoverPhoto';\nimport PopUp from \"../../components/PopUp\";\nimport { Elements, StripeProvider } from 'react-stripe-elements';\nimport CheckoutForm from \"../../components/Checkout\";\nimport \"./cart.css\";\n\nvar Cart =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Cart, _Component);\n\n  function Cart() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Cart);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Cart)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      user: \"\",\n      cart: [],\n      allS3Files: [],\n      imagesInCart: [],\n      price: 10,\n      total: 0,\n      purchaseClicked: false\n    };\n\n    _this.getUser = function () {\n      API.fetchUser().then(function (res) {\n        return _this.setState({\n          user: res.data,\n          cart: res.data.cart\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.getFiles = function () {\n      API.getFiles().then(function (res) {\n        return _this.setState({\n          allS3Files: res.data\n        });\n      }).then(function (res) {\n        return _this.getImagesInCart();\n      }).then(function (res) {\n        return _this.getTotal();\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.onRemoveClick = function (e) {\n      // console.log(e.target.getAttribute('data-id'));\n      API.removeOneFromCart(_this.state.user._id, e.target.getAttribute('data-id')).then(_this.getUser(), _this.getFiles(), _this.getImagesInCart()).catch(function (err) {\n        return console.log(err);\n      }) // .then(this.getUser())\n      // .then(this.getImagesInCart())\n      .catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.onEmptyClick = function () {\n      API.emptyCart(_this.state.user._id).then(_this.getUser(), _this.getFiles()).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.closePopUp = function () {\n      _this.setState({\n        purchaseClicked: false\n      });\n    };\n\n    _this.onPurchaseClick = function () {\n      console.log(\"purchase clicked\");\n\n      _this.setState({\n        purchaseClicked: true\n      });\n\n      if (_this.state.imagesInCart.length === 0) {\n        alert(\"no items in your cart\");\n      }\n    };\n\n    _this.getTotal = function () {\n      var total = _this.state.imagesInCart.length * _this.state.price;\n\n      _this.setState({\n        total: total\n      });\n    };\n\n    _this.getImagesInCart = function () {\n      //  console.log(\"got images in cart!\")\n      var s3FilesArr = [];\n      var cart = _this.state.cart;\n\n      for (var i = 0; i < _this.state.allS3Files.length; i++) {\n        s3FilesArr.push(_this.state.allS3Files[i].filename);\n      }\n\n      _this.setState({\n        imagesInCart: s3FilesArr.filter(function (value) {\n          return -1 !== cart.indexOf(value);\n        })\n      }); // console.log(this.state.imagesInCart)\n\n    };\n\n    _this.downloadAllSets = function () {\n      console.log(\"dowload all sets\");\n\n      for (var i = 0; i < _this.state.imagesInCart.length; i++) {\n        console.log(_this.state.imagesInCart[i]);\n        API.downloadSet(_this.state.imagesInCart[i].slice(0, -3)) // .then(res=> console.log(res.data))\n        .then(function (res) {\n          return window.open(res.data);\n        }, _this.onEmptyClick()).catch(function (err) {\n          return console.log(err);\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(Cart, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.getUser();\n      this.getFiles(); //  this.getTotal();\n      //  this.getImagesInCart();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      // console.log(this.state.cart);\n      return React.createElement(\"div\", {\n        className: \"cart-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"title-empty-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        id: \"title-cart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, \"items in your cart\"), this.state.imagesInCart.length > 0 ? React.createElement(\"button\", {\n        className: \"empty-cart-btn\",\n        onClick: this.onEmptyClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \"empty your cart\") : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"cart-items-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, this.state.imagesInCart.length > 0 ? // <div> The is stuff in your cart!!!! </div>\n      this.state.imagesInCart.map(function (image, index) {\n        return React.createElement(\"div\", {\n          className: \"image-info-container\",\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, React.createElement(Link, {\n          key: index,\n          to: \"/set/\".concat(image),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, React.createElement(CoverPhoto, {\n          key: index,\n          fileName: image,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"name-price-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"cart-model-name\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }, \" \", image.slice(0, -4), \" \"), React.createElement(\"span\", {\n          className: \"cart-separator\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }, \" / \"), React.createElement(\"span\", {\n          className: \"cart-price\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, \" $\", _this2.state.price)), React.createElement(\"button\", {\n          onClick: _this2.onRemoveClick,\n          className: \"remove-btn\",\n          \"data-id\": image,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, \" remove\"));\n      }) : React.createElement(\"div\", {\n        className: \"empty-cart-message\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Your cart is empty\")), React.createElement(\"div\", {\n        className: \"total-purchase-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        className: \"total-all\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"total-span\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"total is : \"), this.state.total, \"$\"), React.createElement(\"button\", {\n        onClick: this.onPurchaseClick,\n        className: \"purchase-btn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \" purchase \")), this.state.purchaseClicked && this.state.imagesInCart.length > 0 ? React.createElement(PopUp, {\n        buttonClicked: \"purchase\",\n        fetchUser: this.props.fetchUser,\n        closePopUp: this.closePopUp,\n        paymentForm: React.createElement(StripeProvider, {\n          apiKey: \"pk_test_Dnlcd3u8fxuOGycdNZ68LyJ200n3Qm5pGW\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"example\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, React.createElement(Elements, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, React.createElement(CheckoutForm, {\n          downloadAllSets: this.downloadAllSets,\n          userId: this.state.user._id,\n          cartItems: this.state.cart,\n          amount: this.state.total,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        })))),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Cart;\n}(Component);\n\n;\nexport default Cart;","map":{"version":3,"sources":["/Users/bradleyjones/Desktop/code/eNatomy/enatomy-app/client/src/pages/Cart/Cart.js"],"names":["React","Component","API","Link","CoverPhoto","PopUp","Elements","StripeProvider","CheckoutForm","Cart","state","user","cart","allS3Files","imagesInCart","price","total","purchaseClicked","getUser","fetchUser","then","res","setState","data","catch","err","console","log","getFiles","getImagesInCart","getTotal","onRemoveClick","e","removeOneFromCart","_id","target","getAttribute","onEmptyClick","emptyCart","closePopUp","onPurchaseClick","length","alert","s3FilesArr","i","push","filename","filter","value","indexOf","downloadAllSets","downloadSet","slice","window","open","map","image","index","props"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport API from \"../../utils/API\";\nimport { Link } from 'react-router-dom';\nimport CoverPhoto from '../../components/CoverPhoto';\nimport PopUp from \"../../components/PopUp\";\n\nimport {Elements, StripeProvider} from 'react-stripe-elements';\nimport CheckoutForm from \"../../components/Checkout\";\n\n\nimport \"./cart.css\";\n\n\n\nclass Cart extends Component {\n    state = {\n      user:\"\",\n      cart:[],\n      allS3Files:[],\n      imagesInCart:[],\n      price:10,\n      total:0,\n      purchaseClicked:false,\n     }\n\n\n     componentWillMount() {\n       this.getUser();\n       this.getFiles();\n      //  this.getTotal();\n      //  this.getImagesInCart();\n\n     }\n\n   getUser = () => {\n    API.fetchUser() \n      .then(res => this.setState({\n        user:res.data,\n        cart:res.data.cart\n      }))\n      .catch(err => console.log(err))\n  };\n\n  getFiles = () => {\n    API.getFiles() \n      .then(res => this.setState({\n        allS3Files:res.data\n      }))\n      .then(res => this.getImagesInCart())\n      .then(res => this.getTotal())\n      .catch(err => console.log(err))\n  };\n\n  onRemoveClick = (e) => {\n    // console.log(e.target.getAttribute('data-id'));\n    API.removeOneFromCart(this.state.user._id, e.target.getAttribute('data-id'))\n   .then( this.getUser(), this.getFiles(),this.getImagesInCart())\n    .catch(err => console.log(err))\n    // .then(this.getUser())\n    // .then(this.getImagesInCart())\n    .catch(err => console.log(err));\n  }\n\n  onEmptyClick = () => {\n    API.emptyCart(this.state.user._id)\n    .then(this.getUser(), this.getFiles())\n    .catch(err => console.log(err))\n\n  }\n\n  closePopUp = () => {\n    this.setState({\n       purchaseClicked:false,\n      })\n }\n\n  onPurchaseClick = () => {\n    console.log(\"purchase clicked\")\n    this.setState({\n       purchaseClicked:true\n    })\n    if(this.state.imagesInCart.length === 0){\n      alert(\"no items in your cart\")\n    }\n  }\n\n\n  getTotal = () => {\n    let total = (this.state.imagesInCart.length * this.state.price);\n    this.setState({\n      total:total\n    })\n }\n\n getImagesInCart = () => {\n  //  console.log(\"got images in cart!\")\n  let s3FilesArr = []\n  let cart = this.state.cart;\n   for (var i = 0; i < this.state.allS3Files.length; i++){\n      s3FilesArr.push(this.state.allS3Files[i].filename);\n  }\n    this.setState({\n    imagesInCart:s3FilesArr.filter(value => -1 !== cart.indexOf(value))\n  }) \n  // console.log(this.state.imagesInCart)\n }\n\n downloadAllSets = () => {\n    console.log(\"dowload all sets\");\n\n    for(var i=0; i < this.state.imagesInCart.length;i++){\n      console.log(this.state.imagesInCart[i])\n      API.downloadSet(this.state.imagesInCart[i].slice(0, -3))\n      // .then(res=> console.log(res.data))\n      .then(res => window.open(res.data), this.onEmptyClick())\n      .catch(err => console.log(err))\n    }\n\n }\n\n\nrender() {\n  // console.log(this.state.cart);\n\n          return (\n                <div className=\"cart-container\">\n                  <div className=\"title-empty-container\">\n                    <span id=\"title-cart\">items in your cart</span>\n                    {(this.state.imagesInCart.length > 0) ?  <button className=\"empty-cart-btn\" onClick = {this.onEmptyClick}>empty your cart</button>: <div></div>}\n                  </div>\n                  {/* <h2> first in cart is {this.state.cart[0]}</h2> */}\n                  <div className=\"cart-items-container\">\n                  {(this.state.imagesInCart.length > 0) ? \n                  // <div> The is stuff in your cart!!!! </div>\n                  this.state.imagesInCart.map((image,index) => (\n                    <div className=\"image-info-container\" key={index}>\n                    <Link key={index} to={`/set/${image}`}>\n                         <CoverPhoto key={index} fileName={image}>\n                         </CoverPhoto>\n                    </Link> \n                    <div className=\"name-price-container\">\n                      <span className=\"cart-model-name\"> {image.slice(0, -4)} </span>\n                      <span className=\"cart-separator\"> / </span>\n                      <span className=\"cart-price\"> ${this.state.price}</span>\n                    </div>\n                    <button onClick={this.onRemoveClick} className=\"remove-btn\" data-id={image}> remove</button>\n                  \n                  </div>\n                  ))\n                  : <div className=\"empty-cart-message\">Your cart is empty</div>}\n                    {/* {this.renderItemsInCart()} */}\n\n                  </div>\n                     \n                  \n                   <div className=\"total-purchase-container\">\n                      <h4 className=\"total-all\"><span className=\"total-span\">total is : </span>{this.state.total}$</h4>\n\n                      <button onClick={this.onPurchaseClick} className=\"purchase-btn\"> purchase </button>\n                   </div>\n\n                   {this.state.purchaseClicked && this.state.imagesInCart.length > 0? <PopUp buttonClicked=\"purchase\" fetchUser={this.props.fetchUser} closePopUp={this.closePopUp} paymentForm={<StripeProvider apiKey=\"pk_test_Dnlcd3u8fxuOGycdNZ68LyJ200n3Qm5pGW\">\n                      <div className=\"example\">\n                        <Elements>\n                          <CheckoutForm  downloadAllSets={this.downloadAllSets}  userId={this.state.user._id} cartItems={this.state.cart} amount={this.state.total} />\n                        </Elements>\n                       </div>\n                   </StripeProvider>}>\n                   \n                   </PopUp>: <div></div>}\n                   \n                </div>\n            )\n          }\n        };\n        export default Cart"]},"metadata":{},"sourceType":"module"}